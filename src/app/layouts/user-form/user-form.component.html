<app-auth>
  <div class="form-container">
    <form *ngIf="isCreateUser || isRegister" #form="ngForm" (ngSubmit)="onSubmit()" class="form">
      <app-title [pageTitle]="pageTitle"></app-title>

      <div *ngIf="isSubmitted && getMessage()" [ngClass]="submitError ? 'error-message' : 'success-message'">
        <p class="error">{{ getMessage() }}</p>
      </div>

      <div class="input-container">
        <app-base-input
          class="input-create-account"
          type="text"
          inputMode="tel"
          placeholder="No Pegawai"
          name="no_pegawai"
          [(ngModel)]="user.no_pegawai"
          #noPegawai="ngModel"
        ></app-base-input>

        <app-input-role-nik
          *ngIf="isCreateUser"
          class="input-create-account"
          [nik]="user.nik"
          (roleIdChange)="onRoleIdChange($event)"
          (nikChange)="onNikChange($event)"
          (validationMessage)="onValidationMessage($event)"
        ></app-input-role-nik>

        <app-base-input
          *ngIf="isRegister"
          class="input-create-account"
          type="text"
          inputMode="tel"
          placeholder="NIK *"
          name="nik"
          [(ngModel)]="user.nik"
          #nik="ngModel"
          [required]="isRegister">
          <p>Masukkan NIK sesuai KTP</p>
        </app-base-input>

        <app-base-input
          class="input-create-account"
          type="text"
          inputMode="text"
          placeholder="Nama Lengkap *"
          name="name"
          [(ngModel)]="user.name"
          #name="ngModel"
          required
          pattern="^[a-zA-Z ]+$">
          <p>Masukkan nama asli, nama akan digunakan pada data sertifikat</p>
        </app-base-input>

        <app-base-input
          class="input-create-account"
          type="email"
          inputMode="email"
          placeholder="Email *"
          name="email"
          [(ngModel)]="user.email"
          [(ngModel)]="user.email"
          #email="ngModel"
          required
          email>
          <p>Gunakan alamat email aktif</p>
        </app-base-input>

        <app-base-input
          class="input-create-account"
          [type]="isPassVisible ? 'text' : 'password'"
          [isPassVisible]="isPassVisible"
          (togglePassClick)="passVisible()"
          inputMode="text"
          placeholder="Password *"
          name="password"
          [(ngModel)]="user.password"
          #password="ngModel"
          [required]="isCreate"
          minlength="8"
          pattern="^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$">
          <p>Gunakan minimal 8 karakter dengan kombinasi huruf besar, huruf kecil dan angka</p>
        </app-base-input>

        <app-base-input
          class="input-create-account"
          type="text"
          inputMode="text"
          placeholder="Dinas"
          name="dinas"
          [(ngModel)]="user.dinas"
        ></app-base-input>
      </div>

      <p *ngIf="isRegister" class="isRegistered">Sudah punya akun? <a routerLink="/login">Masuk</a></p>

      <div class="buttons">
        <app-white-button *ngIf="isCreateUser" type="button" routerLink="/users">Kembali</app-white-button>
        <app-blue-button type="submit" [ngClass]="isRegister ? 'submit' : ''">{{ blueButtonLabel }}</app-blue-button>
      </div>
    </form>

    <form *ngIf="isForgotPassword" #form="ngForm" (ngSubmit)="onSubmit()" class="form">
      <app-title pageTitle="Forgot password"></app-title>

      <div *ngIf="isSubmitted && getMessage()" [ngClass]="submitError ? 'error-message' : 'success-message'">
        <p class="error">{{ getMessage() }}</p>
      </div>

      <div class="input-container" ngClass="email">
        <app-base-input
          type="email"
          inputMode="email"
          placeholder="Email"
          name="email"
          [(ngModel)]="user.email"
          #email="ngModel"
          required
          email>
        </app-base-input>
      </div>

      <div class="buttons">
        <app-white-button type="button" routerLink="/login">Kembali</app-white-button>
        <app-blue-button class="submit" type="submit">Kirim</app-blue-button>
      </div>
    </form>

    <form *ngIf="isResetPassword" #form="ngForm" (ngSubmit)="onSubmit()" class="form">
      <app-title pageTitle="Reset Password"></app-title>

      <div *ngIf="isSubmitted && getMessage()" [ngClass]="submitError ? 'error-message' : 'success-message'">
        <p class="error">{{ getMessage() }}</p>
      </div>

      <div class="input-container">
        <app-base-input
          [type]="isPassVisible ? 'text' : 'password'"
          [isPassVisible]="isPassVisible"
          (togglePassClick)="passVisible()"
          inputMode="text"
          placeholder="Password baru"
          name="newPassword"
          [(ngModel)]="user.newPassword"
          #newPassword="ngModel"
          required
          minlength="8"
          pattern="^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$">
          <p>Gunakan minimal 8 karakter dengan kombinasi huruf dan angka</p>
        </app-base-input>

        <app-base-input
          [type]="isPassVisible ? 'text' : 'password'"
          [isPassVisible]="isPassVisible"
          (togglePassClick)="passVisible()"
          inputMode="text"
          placeholder="Konfirmasi password baru"
          name="confirmNewPassword"
          [(ngModel)]="user.confirmNewPassword"
          #confirmNewPassword="ngModel"
          required
          minlength="8"
          pattern="^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$">
          <p>Gunakan minimal 8 karakter dengan kombinasi huruf dan angka</p>
        </app-base-input>
      </div>

      <div class="buttons">
        <app-white-button type="button" routerLink="/login">Kembali</app-white-button>
        <app-blue-button class="submit" type="submit">Simpan</app-blue-button>
      </div>
    </form>
  </div>
</app-auth>
